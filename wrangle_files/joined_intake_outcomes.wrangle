join with: first_clean_outcomes col: visit_id = current_dataset.visit_id, animal_id = current_dataset.animal_id, visit_num = current_dataset.visit_num, name = current_dataset.name, intake_date = current_dataset.intake_date, intake_time = current_dataset.intake_time, intake_type = current_dataset.intake_type, intake_condition = current_dataset.intake_condition, needs_attention = current_dataset.needs_attention, animal_type = current_dataset.animal_type, sex = current_dataset.sex, reproductive_status_intake = current_dataset.reproductive_status_intake, birth_date = current_dataset.birth_date, breed = current_dataset.breed, color = current_dataset.color, outcome_date = first_clean_outcomes.outcome_date, outcome_time = first_clean_outcomes.outcome_time, outcome_type = first_clean_outcomes.outcome_type, outcome_subtype = first_clean_outcomes.outcome_subtype, reproductive_status_outcome = first_clean_outcomes.reproductive_status_outcome row: REMOVEWHITESPACE(current_dataset.visit_id) == REMOVEWHITESPACE(first_clean_outcomes.visit_id_outcome) type: full
derive type: single value: ISMISSING([outcome_date]) as: 'in_shelter'
case condition: ifThenElse if: in_shelter == true then: DATEDIF(intake_date, TODAY('America\/New_York'), day) else: DATEDIF(intake_date, outcome_date, day) as: 'days_in_shelter'